{
    include "testsuite.ycp";

    import "YaPI::DNSD";
    import "Mode";
    import "Progress";

    Mode::test = true;

    Progress::off ();

    map READ = $[
	// Runlevel
        "init": $[
            "scripts": $[
                "exists": true,
                "runlevel": $[
                    "named": $[
                        "start": [],
                        "stop":  [],
                        ],
                    ],
                // their contents is not important for ServiceAdjust
                "comment": $[
                    "named": $[],
                    ],
                ],
            ],

	"target" : $[
	    "stat" : $[],
	    "ycp" : $[],
	],
	"dns" : $[
	    "named" : $[
		"section" : $[
		    "options" : "",
		    "zone \"localhost\" in" : "",
		],
		"value" : $[
		    "options" : $[
			"directory" : ["\"/var/lib/named\""],
			"notify" : ["no"],
		    ],
		    "zone \"localhost\" in" : $[
			"type" : ["master"],
			"file" : ["\"localhost.zone\""],
		    ],
		    "acl" : [],
		],
	    ],
	    "zone" : $[
		"TTL":"1W",
		"records":[
		    $[
			"key":"",
			"type":"NS",
			"value":"@"
		    ], $[
			"key":"",
			"type":"A",
			"value":"127.0.0.1"
		    ], $[
			"key" : "localhost2",
			"type" : "A",
			"value" : "127.0.0.2"
		    ],
		],
		"soa":$[
		    "expiry":"6W",
		    "mail":"root",
		    "minimum":"1W",
		    "refresh":"2D",
		    "retry":"4H",
		    "serial":42,
		    "server":"@",
		    "zone":"@"
		]
	    ],
	],
        "sysconfig" : $[
	    "network" : $[
		"config" : $[
		    "MODIFY_NAMED_CONF_DYNAMICALLY" : "yes",
		    "MODIFY_RESOLV_CONF_DYNAMICALLY" : "yes",
		],
	    ],
	],
    ];
    map WRITE = $[];
    map EXEC = $[
	"target" : $[
	    "bash_output" : $["exit" : 1, "stdout" : "", "stderr" : ""],
	],
    ];


    list<map<string,any> > zones = [
	$[
	    "options" : [
		$[
		    "value" : "master",
		    "key" : "type",
		],
		$[
		    "value" : "\"example.com.zone\"",
		    "key" : "file",
		]
	    ],
	    "zone" : "example.com",
	    "ttl" : "1W",
	    "records" : [
		$[
		    "value" : "127.0.0.1",
		    "type" : "A",
		    "key" : "host",
		],
		$[
		    "value" : "@",
		    "type" : "NS",
		    "key" : "example.com."
		],
	    ],
	    "file" : "example.com",
	    "type" : "master",
	    "soa" : $[
		"minimum" : "1W",
		"expiry" : "6W",
		"serial" : 2004012701,
		"zone" : "@",
		"retry" : "4H",
		"refresh" : "2D",
		"mail" : "root",
		"server" : "@"
	    ]
	]
    ];


    DUMP ("==========================================================");
    TEST (``(YaPI::DNSD::WriteZones ($[], zones)),
	[READ, WRITE, EXEC], nil);
    DUMP ("==========================================================");
}
